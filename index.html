<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All-in-One Web App</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple spinner */
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #3b82f6; /* Blue */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Hide scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-slate-900 text-white min-h-screen flex items-center justify-center p-4">

    <!-- Professional Card Layout -->
    <div class="max-w-md w-full bg-slate-800 rounded-xl shadow-2xl p-6 overflow-hidden border border-slate-700">
        
        <!-- Header with Gradient Text -->
        <h1 class="text-3xl font-bold text-center mb-2 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
            All-in-One App
        </h1>
        <p class="text-center text-slate-400 mb-6 text-sm">Aapke sabhi tools ek jagah par.</p>

        <!-- Tab Navigation (3 tabs) -->
        <nav class="flex space-x-2 mb-6 rounded-lg bg-slate-700 p-1">
            <button id="reelTabBtn" class="tab-btn w-1/3 p-2 rounded-md font-semibold text-xs md:text-sm transition-colors duration-200 bg-blue-600 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                Reel Downloader
            </button>
            <button id="infoTabBtn" class="tab-btn w-1/3 p-2 rounded-md font-semibold text-xs md:text-sm transition-colors duration-200 bg-slate-700 text-slate-300 hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                Insta Info
            </button>
            <button id="aadhaarTabBtn" class="tab-btn w-1/3 p-2 rounded-md font-semibold text-xs md:text-sm transition-colors duration-200 bg-slate-700 text-slate-300 hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                Aadhaar Info
            </button>
        </nav>

        <!-- Main Content Area -->
        <div class="max-h-[60vh] overflow-y-auto no-scrollbar pr-2">

            <!-- ============================== -->
            <!-- Feature 1: Reel Downloader     -->
            <!-- ============================== -->
            <div id="reelTab" class="tab-content space-y-6">
                <h2 class="text-2xl font-semibold text-center text-slate-100">Instagram Reel Downloader</h2>
                
                <!-- Input Form -->
                <form id="reelForm" class="space-y-4">
                    <div>
                        <label for="reelUrl" class="block text-sm font-medium text-slate-300 mb-2">Reel ka URL paste karein:</label>
                        <input type="url" id="reelUrl" name="reelUrl" class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://www.instagram.com/reel/..." required>
                    </div>
                    <button type="submit" id="downloadBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 ease-in-out transform hover:-translate-y-0.5 shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                        Download Karein
                    </button>
                </form>

                <!-- Loading Spinner -->
                <div id="loader" class="hidden flex justify-center items-center py-4">
                    <div class="loader"></div>
                </div>

                <!-- Error Message -->
                <div id="errorMessage" class="hidden text-center bg-red-900 border border-red-700 text-white p-3 rounded-lg">
                    <!-- Error content will be set by JS -->
                </div>

                <!-- Result Display (Thumbnail Removed) -->
                <div id="result" class="hidden space-y-4 mt-6">
                    <h3 class="text-xl font-semibold text-center text-slate-100">Download ke liye Taiyaar!</h3>
                    <video id="videoPreview" controls class="w-full rounded-lg border-2 border-slate-700">
                        <source src="" type="video/mp4">
                        Aapka browser video tag support nahi karta.
                    </video>
                    <a id="downloadLink" href="" target="_blank" download="downloaded_reel.mp4" class="block w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 text-center shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50">
                        Video Download Karein
                    </a>
                </div>
            </div>

            <!-- ============================== -->
            <!-- Feature 2: Insta Info          -->
            <!-- ============================== -->
            <div id="infoTab" class="tab-content hidden space-y-6">
                <h2 class="text-2xl font-semibold text-center text-slate-100">Instagram Info Finder</h2>
                
                <!-- Info Input Form -->
                <form id="infoForm" class="space-y-4">
                    <div>
                        <label for="username" class="block text-sm font-medium text-slate-300 mb-2">Username daalein (bina @):</label>
                        <input type="text" id="username" name="username" class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="zuck" required>
                    </div>
                    <button type="submit" id="infoBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 ease-in-out transform hover:-translate-y-0.5 shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                        Get Info
                    </button>
                </form>

                <!-- Info Loading Spinner -->
                <div id="infoLoader" class="hidden flex justify-center items-center py-4">
                    <div class="loader"></div>
                </div>

                <!-- Info Error Message -->
                <div id="infoErrorMessage" class="hidden text-center bg-red-900 border border-red-700 text-white p-3 rounded-lg">
                    <!-- Error content will be set by JS -->
                </div>

                <!-- Info Result Display -->
                <div id="infoResult" class="hidden space-y-4 mt-6">
                    <img id="infoProfilePic" src="" alt="Profile Picture" class="w-24 h-24 rounded-full mx-auto border-4 border-blue-400 shadow-lg object-cover" onerror="this.src='https://placehold.co/96x96/1e293b/ffffff?text=Profile'">
                    <div class="flex space-x-4">
                        <a id="infoProfilePicLink" href="" target="_blank" class="block w-1/2 bg-slate-600 hover:bg-slate-500 text-white font-bold py-2 px-4 rounded-lg transition duration-300 text-center text-sm focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-opacity-50">
                            Download Profile Pic
                        </a>
                        <a id="infoProfileLink" href="" target="_blank" class="block w-1/2 bg-pink-600 hover:bg-pink-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 text-center text-sm focus:outline-none focus:ring-2 focus:ring-pink-400 focus:ring-opacity-50">
                            Open Instagram
                        </a>
                    </div>
                    <div class="bg-slate-700 p-4 rounded-lg space-y-2 text-sm">
                        <p><strong>Username:</strong> <span id="infoUsername" class="text-blue-300"></span></p>
                        <p><strong>Full Name:</strong> <span id="infoFullName" class="text-slate-200"></span></p>
                        <p><strong>Bio:</strong> <span id="infoBio" class="text-slate-300 italic"></span></p>
                        <hr class="border-slate-600">
                        <div class="grid grid-cols-2 gap-x-4 gap-y-2">
                            <p><strong>Followers:</strong> <span id="infoFollowers"></span></p>
                            <p><strong>Following:</strong> <span id="infoFollowing"></span></p>
                            <p><strong>Posts:</strong> <span id="infoPosts"></span></p>
                            <p><strong>Verified:</strong> <span id="infoVerified"></span></p>
                            <p><strong>Private:</strong> <span id="infoPrivate"></span></p>
                            <p><strong>Business:</strong> <span id="infoBusiness"></span></p>
                            <p><strong>Professional:</strong> <span id="infoProfessional"></span></p>
                            <p><strong>Meta Enabled:</strong> <span id="infoMetaEnabled"></span></p>
                        </div>
                        <p class="pt-2"><strong>Category:</strong> <span id="infoCategory" class="text-slate-400"></span></p>
                    </div>
                </div>
            </div>

            <!-- ============================== -->
            <!-- Feature 3: Aadhaar Info        -->
            <!-- ============================== -->
            <div id="aadhaarTab" class="tab-content hidden space-y-6">
                <h2 class="text-2xl font-semibold text-center text-slate-100">Aadhaar Family Info</h2>
                
                <!-- Aadhaar Input Form -->
                <form id="aadhaarForm" class="space-y-4">
                    <div>
                        <label for="aadhaarNumber" class="block text-sm font-medium text-slate-300 mb-2">Aadhaar Number daalein:</label>
                        <input type="text" id="aadhaarNumber" name="aadhaarNumber" inputmode="numeric" pattern="[0-9]*" class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="12-digit Aadhaar Number" required>
                    </div>
                    <button type="submit" id="aadhaarBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 ease-in-out transform hover:-translate-y-0.5 shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                        Get Family Info
                    </button>
                </form>

                <!-- Aadhaar Loading Spinner -->
                <div id="aadhaarLoader" class="hidden flex justify-center items-center py-4">
                    <div class="loader"></div>
                </div>

                <!-- Aadhaar Error Message -->
                <div id="aadhaarErrorMessage" class="hidden text-center bg-red-900 border border-red-700 text-white p-3 rounded-lg">
                    <!-- Error content will be set by JS -->
                </div>

                <!-- Aadhaar Result Display -->
                <div id="aadhaarResult" class="hidden space-y-4 mt-6">
                    
                    <!-- RC Details Card -->
                    <div class="bg-slate-700 p-4 rounded-lg space-y-2 text-sm">
                        <h3 class="text-lg font-semibold text-white mb-2">Ration Card Details</h3>
                        <div class="grid grid-cols-2 gap-x-4 gap-y-2">
                            <p><strong>RC ID:</strong> <span id="rcId" class="text-blue-300"></span></p>
                            <p><strong>Scheme:</strong> <span id="schemeName" class="text-slate-300"></span></p>
                            <p><strong>State:</strong> <span id="homeStateName" class="text-slate-300"></span></p>
                            <p><strong>District:</strong> <span id="homeDistName" class="text-slate-300"></span></p>
                        </div>
                    </div>
                    
                    <!-- Family Members List -->
                    <div>
                        <h3 class="text-lg font-semibold text-white mb-3">Family Members</h3>
                        <div id="memberListContainer" class="space-y-3">
                            <!-- Member cards will be injected here by JS -->
                        </div>
                    </div>

                </div>
            </div>

        </div> <!-- End of scrollable content area -->

        <!-- Developer Credit -->
        <div class="text-center pt-5 mt-5 border-t border-slate-700">
            <p class="text-slate-500 text-sm">
                Developed by 
                <a href="https://t.me/Wamphire" target="_blank" rel="noopener noreferrer" class="font-medium text-blue-400 hover:text-blue-300 transition-colors">
                    Wamphire
                </a>
            </p>
        </div>

    </div> <!-- End of card -->

    <script>
        // ===================================
        // Tab Switching Logic (3 Tabs)
        // ===================================
        const reelTabBtn = document.getElementById('reelTabBtn');
        const infoTabBtn = document.getElementById('infoTabBtn');
        const aadhaarTabBtn = document.getElementById('aadhaarTabBtn');
        
        const reelTab = document.getElementById('reelTab');
        const infoTab = document.getElementById('infoTab');
        const aadhaarTab = document.getElementById('aadhaarTab');

        const tabs = [reelTab, infoTab, aadhaarTab];
        const tabButtons = [reelTabBtn, infoTabBtn, aadhaarTabBtn];

        function switchTab(tabToShow, buttonToActivate) {
            // Hide all tabs
            tabs.forEach(tab => tab.classList.add('hidden'));
            // Deactivate all buttons
            tabButtons.forEach(btn => {
                btn.classList.add('bg-slate-700', 'text-slate-300', 'hover:bg-slate-600');
                btn.classList.remove('bg-blue-600', 'text-white');
            });

            // Show the active tab
            tabToShow.classList.remove('hidden');
            // Activate the active button
            buttonToActivate.classList.add('bg-blue-600', 'text-white');
            buttonToActivate.classList.remove('bg-slate-700', 'text-slate-300', 'hover:bg-slate-600');
        }

        reelTabBtn.addEventListener('click', () => switchTab(reelTab, reelTabBtn));
        infoTabBtn.addEventListener('click', () => switchTab(infoTab, infoTabBtn));
        aadhaarTabBtn.addEventListener('click', () => switchTab(aadhaarTab, aadhaarTabBtn));


        // ===================================
        // Reel Downloader Logic
        // ===================================
        const reelForm = document.getElementById('reelForm');
        const urlInput = document.getElementById('reelUrl');
        const downloadBtn = document.getElementById('downloadBtn');
        const loader = document.getElementById('loader');
        const errorMessage = document.getElementById('errorMessage');
        const resultDiv = document.getElementById('result');
        const videoPreview = document.getElementById('videoPreview');
        const downloadLink = document.getElementById('downloadLink');

        // --- API URL UPDATED ---
        const REEL_API_BASE = 'https://hidden-resonance-c0ec.tubemusical7.workers.dev/?url=';

        reelForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const reelUrl = urlInput.value.trim();
            if (!reelUrl) { showReelError('Please ek valid URL daalein.'); return; }

            showReelLoading(true);
            showReelError(null);
            showReelResult(false);
            downloadBtn.disabled = true;
            downloadBtn.textContent = 'Loading...';

            try {
                const apiUrl = `${REEL_API_BASE}${encodeURIComponent(reelUrl)}`;
                const response = await fetch(apiUrl);

                // Check agar response JSON nahi hai (kabhi kabhi API alag error deti hai)
                if (!response.headers.get("content-type")?.includes("application/json")) {
                    const errorText = await response.text();
                    throw new Error(`API se valid response nahi mila. Server kehta hai: ${errorText.substring(0, 100)}`);
                }
                
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || data.error || `Server se error aaya: ${response.status}`);
                }

                if (data.status === 'success' && data.video) {
                    videoPreview.querySelector('source').src = data.video;
                    videoPreview.load();
                    downloadLink.href = data.video;
                    showReelResult(true);
                } else {
                    throw new Error(data.message || data.error || 'Invalid Reel URL ya API se koi error aaya hai.');
                }
            } catch (error) {
                console.error('Reel Fetch error:', error);
                let friendlyMessage = `Ek error aa gaya: ${error.message}`;
                // Kyunki user ne kaha hai CORS fixed hai, yeh error ab sach mein network issue hoga
                if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
                    friendlyMessage = 'Network error. Apna internet check karein ya API server down hai.';
                }
                showReelError(friendlyMessage);
            } finally {
                showReelLoading(false);
                downloadBtn.disabled = false;
                downloadBtn.textContent = 'Download Karein';
            }
        });

        function showReelLoading(isLoading) { loader.classList.toggle('hidden', !isLoading); }
        function showReelError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.toggle('hidden', !message);
        }
        function showReelResult(show) { resultDiv.classList.toggle('hidden', !show); }


        // ===================================
        // Insta Info Logic
        // ===================================
        const infoForm = document.getElementById('infoForm');
        const usernameInput = document.getElementById('username');
        const infoBtn = document.getElementById('infoBtn');
        const infoLoader = document.getElementById('infoLoader');
        const infoErrorMessage = document.getElementById('infoErrorMessage');
        const infoResult = document.getElementById('infoResult');
        const infoProfilePic = document.getElementById('infoProfilePic');
        const infoProfilePicLink = document.getElementById('infoProfilePicLink');
        const infoProfileLink = document.getElementById('infoProfileLink');
        const infoUsername = document.getElementById('infoUsername');
        const infoFullName = document.getElementById('infoFullName');
        const infoBio = document.getElementById('infoBio');
        const infoFollowers = document.getElementById('infoFollowers');
        const infoFollowing = document.getElementById('infoFollowing');
        const infoPosts = document.getElementById('infoPosts');
        const infoVerified = document.getElementById('infoVerified');
        const infoPrivate = document.getElementById('infoPrivate');
        const infoBusiness = document.getElementById('infoBusiness');
        const infoProfessional = document.getElementById('infoProfessional');
        const infoMetaEnabled = document.getElementById('infoMetaEnabled');
        const infoCategory = document.getElementById('infoCategory');

        const INFO_API_BASE = 'https://insta-info2.tubemusical7.workers.dev/api/info?username=';
        const IMAGE_PROXY_BASE = 'https://images.weserv.nl/?url=';

        infoForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = usernameInput.value.trim().replace('@', '');
            if (!username) { showInfoError('Please ek valid username daalein.'); return; }

            showInfoLoading(true);
            showInfoError(null);
            showInfoResult(false);
            infoBtn.disabled = true;
            infoBtn.textContent = 'Loading...';

            try {
                const apiUrl = `${INFO_API_BASE}${encodeURIComponent(username)}`;
                const response = await fetch(apiUrl);
                const data = await response.json();

                if (!response.ok) { throw new Error(data.message || `Server error: ${response.status}`); }
                if (data.status === 'error') { throw new Error(data.message || 'User not found.'); }

                const originalImageUrl = data.profile_pic_url;
                const placeholderUrl = 'https://placehold.co/96x96/1e293b/ffffff?text=Profile';
                const errorPlaceholderUrl = 'https://placehold.co/96x96/1e293b/ffffff?text=N/A';

                infoProfilePic.src = originalImageUrl ? `${IMAGE_PROXY_BASE}${encodeURIComponent(originalImageUrl)}` : placeholderUrl;
                infoProfilePic.onerror = () => { infoProfilePic.src = errorPlaceholderUrl; };
                infoProfilePicLink.href = originalImageUrl || '#'; 
                infoProfilePicLink.download = `${data.username || 'profile'}.jpg`; 
                infoProfileLink.href = data.profile_url || `https://instagram.com/${username}`; 

                infoUsername.textContent = data.username || 'N/A';
                infoFullName.textContent = data.full_name || 'N/A';
                infoBio.textContent = data.bio || 'N/A';
                infoFollowers.textContent = data.followers ? new Intl.NumberFormat().format(data.followers) : 'N/A';
                infoFollowing.textContent = data.following ? new Intl.NumberFormat().format(data.following) : 'N/A';
                infoPosts.textContent = data.posts ? new Intl.NumberFormat().format(data.posts) : 'N/A';
                infoVerified.textContent = data.is_verified ? 'Yes' : 'No';
                infoPrivate.textContent = data.is_private ? 'Yes' : 'No';
                infoBusiness.textContent = data.is_business ? 'Yes' : 'No';
                infoProfessional.textContent = data.is_professional ? 'Yes' : 'No';
                infoMetaEnabled.textContent = data.meta_enabled ? 'Yes' : 'No';
                infoCategory.textContent = data.category || 'N/A';
                
                showInfoResult(true);

            } catch (error) {
                console.error('Info Fetch error:', error);
                let friendlyMessage = `Error: ${error.message}`;
                if (error.message.includes('Failed to fetch')) { friendlyMessage = 'Network error. Apna internet check karein ya API server down hai.'; }
                else if (error.message.includes('User not found')) { friendlyMessage = 'User not found. Username check karein.'; }
                showInfoError(friendlyMessage);
            } finally {
                showInfoLoading(false);
                infoBtn.disabled = false;
                infoBtn.textContent = 'Get Info';
            }
        });

        function showInfoLoading(isLoading) { infoLoader.classList.toggle('hidden', !isLoading); }
        function showInfoError(message) {
            infoErrorMessage.textContent = message;
            infoErrorMessage.classList.toggle('hidden', !message);
        }
        function showInfoResult(show) { infoResult.classList.toggle('hidden', !show); }


        // ===================================
        // Aadhaar Info Logic (PROXY REMOVED)
        // ===================================
        const aadhaarForm = document.getElementById('aadhaarForm');
        const aadhaarNumberInput = document.getElementById('aadhaarNumber');
        const aadhaarBtn = document.getElementById('aadhaarBtn');
        const aadhaarLoader = document.getElementById('aadhaarLoader');
        const aadhaarErrorMessage = document.getElementById('aadhaarErrorMessage');
        const aadhaarResult = document.getElementById('aadhaarResult');
        
        // Aadhaar Result fields
        const rcId = document.getElementById('rcId');
        const schemeName = document.getElementById('schemeName');
        const homeStateName = document.getElementById('homeStateName');
        const homeDistName = document.getElementById('homeDistName');
        const memberListContainer = document.getElementById('memberListContainer');

        const AADHAAR_API_BASE = 'https://adhar-opal.vercel.app/api/fetch?key=wamphire&aadhaar=';

        aadhaarForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const aadhaarNumber = aadhaarNumberInput.value.trim();
            if (!aadhaarNumber) {
                showAadhaarError('Please ek valid Aadhaar number daalein.');
                return;
            }

            showAadhaarLoading(true);
            showAadhaarError(null);
            showAadhaarResult(false);
            aadhaarBtn.disabled = true;
            aadhaarBtn.textContent = 'Loading...';

            try {
                // Direct API call (NO PROXY)
                const apiUrl = `${AADHAAR_API_BASE}${encodeURIComponent(aadhaarNumber)}`;
                const response = await fetch(apiUrl);
                const data = await response.json(); // Direct .json()

                if (!response.ok || data.error) {
                    throw new Error(data.error || data.message || `Server error: ${response.status}`);
                }

                // Populate RC Details
                rcId.textContent = data.rcId || 'N/A';
                schemeName.textContent = data.schemeName || 'N/A';
                homeStateName.textContent = data.homeStateName || 'N/A';
                homeDistName.textContent = data.homeDistName || 'N/A';

                // Populate Family Members
                memberListContainer.innerHTML = ''; // Clear previous results
                if (data.memberDetailsList && data.memberDetailsList.length > 0) {
                    data.memberDetailsList.forEach(member => {
                        const uidLinked = member.uid === 'Yes';
                        const uidStatusClass = uidLinked
                            ? 'bg-green-500/20 text-green-300'
                            : 'bg-red-500/20 text-red-300';
                        const uidStatusText = uidLinked ? 'Aadhaar Linked' : 'Not Linked';

                        const memberHtml = `
                            <div class="bg-slate-600 p-3 rounded-lg flex justify-between items-center">
                                <div>
                                    <p class="font-semibold text-white">${member.memberName || 'N/A'}</p>
                                    <p class="text-sm text-slate-300">${member.releationship_name || 'N/A'}</p>

                                </div>
                                <span class="text-xs px-2 py-1 rounded-full ${uidStatusClass} font-medium">
                                    ${uidStatusText}
                                </span>
                            </div>
                        `;
                        memberListContainer.innerHTML += memberHtml;
                    });
                } else {
                    memberListContainer.innerHTML = `<p class="text-slate-400 text-center">Is RC ID se koi family members nahi mile.</p>`;
                }
                
                showAadhaarResult(true);

            } catch (error) {
                console.error('Aadhaar Fetch error:', error);
                let friendlyMessage = `Error: ${error.message}`;
                
                if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
                    // Ab yeh error sach mein network issue ya API server down hone par hi aayega
                    friendlyMessage = 'Network error. Apna internet check karein ya API server down hai.';
                } else if (error.message.includes('Invalid')) {
                    friendlyMessage = 'Invalid Aadhaar Number. Kripya check karein.';
                }
                
                showAadhaarError(friendlyMessage);
            } finally {
                showAadhaarLoading(false);
                aadhaarBtn.disabled = false;
                aadhaarBtn.textContent = 'Get Family Info';
            }
        });

        function showAadhaarLoading(isLoading) { aadhaarLoader.classList.toggle('hidden', !isLoading); }
        function showAadhaarError(message) {
            aadhaarErrorMessage.textContent = message;
            aadhaarErrorMessage.classList.toggle('hidden', !message);
        }
        function showAadhaarResult(show) { aadhaarResult.classList.toggle('hidden', !show); }

    </script>

</body>
</html>